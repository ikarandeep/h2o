<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="index.css">
<<<<<<< HEAD
        <link type="text/javascript" href="index.js">
        
		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBwlu85kqiD-r4vVOHxOwRWrRUnh1N-l9o&sensor=false" ></script>
=======
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBwlu85kqiD-r4vVOHxOwRWrRUnh1N-l9o&sensor=false">
        </script>
>>>>>>> FETCH_HEAD
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script src="http://code.jquery.com/jquery-1.10.1.min.js"> </script>
        <script type="text/javascript">

            // Load visualization
            google.load('visualization', '1.0', {'packages':['corechart']});
            //google.setOnLoadCallback(initialize);

            function initialize() {
                var mapOptions = {
                    center: new google.maps.LatLng(39.33300018310547,-120.25), zoom: 7
                };
                
                var map = new
                    google.maps.Map(document.getElementById("map_canvas"), mapOptions);

                var infowindow = new google.maps.InfoWindow({
                    content: "Hello World"
                });


                $.getJSON('/stations', function(data) {
                    $.each(data, function(i, stn) {
                        var myLatLng = new google.maps.LatLng(stn.lat, stn.lon);
                        var marker = new google.maps.Marker({
                                         position: myLatLng, map: map, title: stn.id
                                         });
                        google.maps.event.addListener(marker, 'click',
                            function() {
                            var id = marker.getTitle();
                            var resturl = '/stationhistory?id='+id;
                            $.getJSON(resturl, function(data) {

                                var dataTable = new google.visualization.DataTable();
                                dataTable.addColumn('string', 'Year/Month');
                                dataTable.addColumn('number', 'Water Level');
                                dataTable.addColumn({'type':'string', 'role':'tooltip', 'p': {'html':true}});
                                for (var i = 0; i < data.length; i++) {
                                //dataTable.addRow([data[i].month+' '+data[i].year, data[i].level]);
                                    if (data[i].month == "Jan") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Jan: </b>'+stn.Jan]);
                                    }
                                    if (data[i].month == "Feb") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Feb: </b>'+stn.Feb]);
                                    }
                                    if (data[i].month == "Mar") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Mar: </b>'+stn.Mar]);
                                    }
                                    if (data[i].month == "Apr") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Apr: </b>'+stn.Apr]);
                                    }
                                    if (data[i].month == "May") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for May: </b>'+stn.May]);
                                    }
                                    if (data[i].month == "Jun") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Jun: </b>'+stn.Jun]);
                                    }
                                    if (data[i].month == "Jul") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Jul: </b>'+stn.Jul]);
                                    }
                                    if (data[i].month == "Aug") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Aug: </b>'+stn.Aug]);
                                    }
                                    if (data[i].month == "Sep") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Sep: </b>'+stn.Sep]);
                                    }
                                    if (data[i].month == "Oct") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Oct: </b>'+stn.Oct]);
                                    }
                                    if (data[i].month == "Nov") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Nov: </b>'+stn.Nov]);
                                    }
                                    if (data[i].month == "Dec") {
                                        dataTable.addRow([data[i].month+' '+data[i].year, 
                                            data[i].level, 
                                            '<b>'+ data[i].month+' '+data[i].year+'<p>'+'Level: </b>'+data[i].level+'<p><b>Avg.  level for Dec: </b>'+stn.Dec]);
                                    }
                                }

                                var options = {'title': 'Water Table over 10 years for '+id,
                                    'tooltip': {isHtml: true}, 
                                    'legend': 'none'
                                };
                                var node = document.createElement('div');
                                node.id = 'chart_canvas';
                                var chart = new google.visualization.ColumnChart(node);
                                chart.draw(dataTable, options);

                                infowindow.setContent(node);
                                infowindow.open(map, marker);
                            });
                        });
                    });
                });
            }
            
			google.maps.event.addDomListener(window, 'load', initialize);
            
            
            function dbRefresh() {
                alert("The refresh will take upto eight minutes. Please be patient. Thank you");
            }
        
        </script>

    </head>

    <body>
    
  		
        <div id="myheader">  <center> <img src="IMG/logo1.png" width="150" height="100" /> </center></div>
        
        <div id="mymenu">
            <nav id="navigation" style="width: 420px; margin: 5px auto 0;">
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Maps</a></li>
                <li><a href="#" id="stations">Contact</a></li>
                <li><a href="#" id="dbrefresh" onclick="dbRefresh()">DB Refresh</a></li>
                
                
                
                            </ul>  
            </nav>
	</div>
<<<<<<< HEAD
        <div id="map_canvas"></div>
	<div id="myfooter">
	 Team 20 (CMPE-272)
        </div>
        
        



    
</body>
=======
        <div id="map_canvas"> </div>
	<div id="myfooter">
	 Team 20 (CMPE-272)
        </div>
    </body>
>>>>>>> FETCH_HEAD
</html>
